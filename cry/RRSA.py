from binascii import *
from gmpy2 import *

x=2
y=83
n=117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127
c=41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128
import sympy
zmax=iroot(n//(x*y),2)[0]
p=sympy.nextprime(zmax)
while n%p!=0:
    p=sympy.prevprime(p)

q=n//p

print(p,q)
ph=(p-1)*(q-1)
e=3
while e:
    if(gcd(e,ph)!=1):
        e=sympy.nextprime(e)
        continue

    d=invert(e,ph)
    t=hex(powmod(c,d,n))[2:]
    if((len(t)&1)):
        e=sympy.nextprime(e)
        continue
    else:    
        m=unhexlify(t)
    if "CTF" in m:
        print(m)
        break
    e=sympy.nextprime(e)
